df <- tribble(
     ~x,    ~y,   ~z, ~group,
  2.620, 16.46, 3.90,      6,
  2.875, 17.02, 3.90,      6,
  2.320, 18.61, 3.85,      4,
  3.215, 19.44, 3.08,      6,
  3.440, 17.02, 3.15,      8,
  3.460, 20.22, 2.76,      6,
  3.570, 15.84, 3.21,      8,
  3.190, 20.00, 3.69,      4,
  3.150, 22.90, 3.92,      4,
  3.440, 18.30, 3.92,      6,
  3.440, 18.90, 3.92,      6,
  4.070, 17.40, 3.07,      8,
  3.730, 17.60, 3.07,      8,
  3.780, 18.00, 3.07,      8,
  5.250, 17.98, 2.93,      8,
  5.424, 17.82, 3.00,      8,
  5.345, 17.42, 3.23,      8,
  2.200, 19.47, 4.08,      4,
  1.615, 18.52, 4.93,      4,
  1.835, 19.90, 4.22,      4,
  2.465, 20.01, 3.70,      4,
  3.520, 16.87, 2.76,      8,
  3.435, 17.30, 3.15,      8,
  3.840, 15.41, 3.73,      8,
  3.845, 17.05, 3.08,      8,
  1.935, 18.90, 4.08,      4,
  2.140, 16.70, 4.43,      4,
  1.513, 16.90, 3.77,      4,
  3.170, 14.50, 4.22,      8,
  2.770, 15.50, 3.62,      6,
  3.570, 14.60, 3.54,      8,
  2.780, 18.60, 4.11,      4
)

coordinates <- df[,c(1:3)]
meta_data <- df[,c(4), drop=FALSE]

test_that("centerOfGroups - 2 dimensions", {
  expect_equal(
    .centerOfGroups(coordinates, meta_data, 2, 'group'),
    tribble(
      ~group,  ~x_median, ~y_median,
           4,        2.2,      18.9,
           6,       3.22,      18.3,
           8,       3.76,      17.2
    ),
    tolerance=0.01
  )
})

test_that("centerOfGroups - 3 dimensions", {
  expect_equal(
    .centerOfGroups(coordinates, meta_data, 3, 'group'),
    tribble(
      ~group,  ~x_median, ~y_median, ~z_median,
           4,        2.2,      18.9,      4.08,
           6,       3.22,      18.3,       3.9,
           8,       3.76,      17.2,      3.12
    ),
    tolerance=0.01
  )
})
