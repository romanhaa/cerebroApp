<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Ideas of what to implement in Cerebro/cerebroApp in the future • cerebroApp</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script>




<meta property="og:title" content="Ideas of what to implement in Cerebro/cerebroApp in the future" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-title-body">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">cerebroApp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="articles/cerebroApp_workflow_Seurat.html">The cerebroApp workflow (Seurat)</a>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">The Cerebro interface</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="articles/Cerebro_interface_v1.2.html">Cerebro v1.2 and older</a>
        </li>
      </ul>
    </li>
    <li>
      <a href="articles/export_a_data_set_in_SCE_format.html">Export an SCE/SingleCellExperiment object</a>
    </li>
    <li>
      <a href="articles/export_and_visualize_custom_tables_and_plots.html">Export and visualize custom tables and plots</a>
    </li>
    <li>
      <a href="articles/launch_cerebro_with_pre-loaded_data_set.html">Launch Cerebro with pre-loaded data set</a>
    </li>
    <li>
      <a href="articles/host_cerebro_on_shinyapps.html">Host Cerebro on shinyapps.io</a>
    </li>
    <li>
      <a href="articles/control_access_to_cerebro_with_a_login_page.html">Control access to Cerebro with a login page</a>
    </li>
    <li>
      <a href="articles/overview_of_cerebro_v1.3_class.html">Overview of the Cerebro v1.3 class</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Release notes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="articles/release_notes_v1.3.html">v1.3</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/romanhaa/cerebroApp/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/fakechek1">
    <span class="fab fa-twitter fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="contents col-md-9">
    <div class="page-header">
      <h1>Ideas of what to implement in Cerebro/cerebroApp in the future</h1>
    </div>


<div id="ideas-of-what-to-implement-in-cerebrocerebroapp-in-the-future" class="section level1">

<div id="general" class="section level2">
<h2 class="hasAnchor">
<a href="#general" class="anchor"></a>General</h2>
<ul>
<li>FAQ on website</li>
<li>List articles that have used Cerebro.</li>
<li>Update article about the Cerebro UI</li>
</ul>
</div>
<div id="cerebroapp" class="section level2">
<h2 class="hasAnchor">
<a href="#cerebroapp" class="anchor"></a>cerebroApp</h2>
<ul>
<li>General
<ul>
<li>Use unit testing</li>
<li>Use modules in Shiny app where it makes sense</li>
<li>Warning when exporting very large expression data (e.g. non-sparse)</li>
<li>Check which tasks are carried out in multiple places and create function for them</li>
<li>Show warning if version of loaded Cerebro object doesn’t match the current Cerebro UI version</li>
<li>Use glue to build messages.</li>
<li>Round values in DT column filtering for numeric values (currently it shows too many decimals)</li>
<li>Thorough performance check with profvis</li>
<li>Make functions compatible with SCE object. Shouldn’t be too much work.</li>
<li>Test memory usage with dgCMatrix and RleMatrix for larger data set.</li>
<li>Don’t call functions in CRB object that don’t exist.</li>
<li>“x_unified” for trend lines: hovering over trend line shows vertical line.</li>
<li>Horizontally align title in box and info button.</li>
</ul>
</li>
<li>New features
<ul>
<li>QC tab</li>
<li>Rename group levels, e.g. clusters</li>
<li>Assign new labels to cells based on selection (create new grouping variable on-the-fly)</li>
<li>Save changes to file</li>
<li>Visualize velocyto results (<code>ggquiver</code>)</li>
<li>Visualize PAGA results</li>
<li>Dot plot as alternative representation of expression of multiple genes across selected grouping variable</li>
<li>Perform statistical analysis on expression of selected genes</li>
<li>Allow export of multiple assays? Paves the way for scRNA-seq + scATAC-seq</li>
<li>Trajectory compatibility with slingshot and Monocle 3.</li>
<li>Upload gene list from file.</li>
<li>Drag resize scatter plots.</li>
</ul>
</li>
<li>Ideas
<ul>
<li>Use “usethis” package.</li>
<li>Function to update old Cerebro objects? It’s easy to just export the Seurat/SCE object again to get the new format.</li>
<li>Store more data in <code>reactiveValues()</code>.</li>
<li>Clean up reactivity dependencies</li>
<li>Function to export cerebroApp for &lt;shinyapps.io&gt;</li>
<li>Use the <a href="https://rinterface.github.io/bs4Dash/index.html"><code>bs4Dash</code> package</a>?</li>
<li>Display logo somewhere more visible in the app?</li>
<li>Build example data set into package and make it loadable.</li>
<li>Save colors in CRB object so it can be loaded next time. [would be solved with new dedicated classes]</li>
<li>Store description of extra material somewhere? [would be solved with new dedicated classes]</li>
<li>Dedicated classes for certain types of content
<ul>
<li>groups (also cell cycle), tables, plots, projections, trajectories</li>
<li>Allows storing descriptions along with tables/plots, etc.</li>
<li>The goal of having very specific classes for Cerebro is to have better control of the data format, as well as being able to combine different types of data that belong together, for example a table (data frame) and a description (string). While R is a functional programming language, I believe it is ok in the context of Cerebro to use introduce specific classes, because they are only meant to be used inside Cerebro, not for other purposes and not for further processing.</li>
<li>Possible problems of using specific classes:
<ul>
<li>How to deal with possible changes to the classes in the future? The object will look the same to Cerebro, but the fields/methods might be different.</li>
</ul>
</li>
<li>Before implementing dedicated object classes, make sure they can be easily integrated in the next release.</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div id="standalone-version" class="section level2">
<h2 class="hasAnchor">
<a href="#standalone-version" class="anchor"></a>Standalone version</h2>
<ul>
<li>Make it work
<ul>
<li>Figure out a way to programmatically create the standalone version, e.g. with the <a href="https://chasemc.github.io/electricShine/"><code>electricShine</code></a> package. Without that, I am stuck with the R version that was provided with the original framework, which is too old for some cerebroApp dependencies.</li>
</ul>
</li>
<li>Other
<ul>
<li>Test memory usage with dgCMatrix and RleMatrix for larger data set.</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="apps-to-take-inspiration-from" class="section level1">
<h1 class="hasAnchor">
<a href="#apps-to-take-inspiration-from" class="anchor"></a>Apps to take inspiration from</h1>
<ul>
<li><a href="https://www.biorxiv.org/content/10.1101/2020.01.25.919712v2">SCANNER</a></li>
<li><a href="https://www.sciencedirect.com/science/article/pii/S0014483520304620">Spectacle</a></li>
</ul>
</div>
<div id="other-useful-links" class="section level1">
<h1 class="hasAnchor">
<a href="#other-useful-links" class="anchor"></a>Other useful links</h1>
<ul>
<li>Discussion on how to make caged/prisoned R installation: <a href="http://r.789695.n4.nabble.com/How-do-I-put-ldpaths-in-a-specific-place-td2964241.html" class="uri">http://r.789695.n4.nabble.com/How-do-I-put-ldpaths-in-a-specific-place-td2964241.html</a>
</li>
<li>Managing multiple R versions on one machine (could be useful for making standalone version)
<ul>
<li><a href="https://mac.r-project.org/#nightly" class="uri">https://mac.r-project.org/#nightly</a></li>
<li><a href="http://r-sig-mac.29524.n8.nabble.com/R-SIG-Mac-R-latest-pkg-link-returning-a-403-Forbidden-error-td693.html#a702" class="uri">http://r-sig-mac.29524.n8.nabble.com/R-SIG-Mac-R-latest-pkg-link-returning-a-403-Forbidden-error-td693.html#a702</a></li>
<li><a href="https://rud.is/rswitch/guide/" class="uri">https://rud.is/rswitch/guide/</a></li>
<li><a href="https://jacobrprice.github.io/2019/09/19/Installing-multiple-parallel-R-versions.html" class="uri">https://jacobrprice.github.io/2019/09/19/Installing-multiple-parallel-R-versions.html</a></li>
<li><a href="https://cran.rstudio.org/doc/manuals/R-admin.html#Uninstalling-under-macOS" class="uri">https://cran.rstudio.org/doc/manuals/R-admin.html#Uninstalling-under-macOS</a></li>
</ul>
</li>
</ul>
</div>
<div id="more-details-for-some-to-dos" class="section level1">
<h1 class="hasAnchor">
<a href="#more-details-for-some-to-dos" class="anchor"></a>More details for some TO DOs</h1>
<div id="testing-which-genes-are-more-variable-than-others-in-a-given-list-of-genes" class="section level2">
<h2 class="hasAnchor">
<a href="#testing-which-genes-are-more-variable-than-others-in-a-given-list-of-genes" class="anchor"></a>Testing which genes are more variable than others in a given list of genes</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">list.of.genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Abcc4'</span>,<span class="st">'Abraxas2'</span>,<span class="st">'Actn4'</span>,<span class="st">'Acvr1'</span>,<span class="st">'Adam9'</span>,<span class="st">'Adamts5'</span>,<span class="st">'Ager'</span>,<span class="st">'Amer2'</span>,<span class="st">'Ank2'</span>,<span class="st">'Api5'</span>,<span class="st">'Bach1'</span>,<span class="st">'Baz2b'</span>,<span class="st">'Bcl11a'</span>,<span class="st">'Bcl2l2'</span>,<span class="st">'Bcl9'</span>,<span class="st">'Bmt2'</span>,<span class="st">'1700025G04Rik'</span>,<span class="st">'1190002N15Rik'</span>,<span class="st">'Cacna1c'</span>,<span class="st">'Cebpa'</span>,<span class="st">'Chd4'</span>,<span class="st">'Cit'</span>,<span class="st">'Col23a1'</span>,<span class="st">'Csk'</span>,<span class="st">'Csnk1g3'</span>,<span class="st">'Ctcf'</span>,<span class="st">'Cul3'</span>,<span class="st">'Dazl'</span>,<span class="st">'Dbndd2'</span>,<span class="st">'Dcun1d4'</span>,<span class="st">'Ddx3x'</span>,<span class="st">'Ddx3y'</span>,<span class="st">'Dhx57'</span>,<span class="st">'Dpp4'</span>,<span class="st">'Dscam'</span>,<span class="st">'Dtna'</span>,<span class="st">'E2f3'</span>,<span class="st">'Ehd1'</span>,<span class="st">'Ephb1'</span>,<span class="st">'Erc2'</span>,<span class="st">'Etv3'</span>,<span class="st">'Eya2'</span>,<span class="st">'Fam214a'</span>,<span class="st">'Gabarap'</span>,<span class="st">'Galnt16'</span>,<span class="st">'Gdf6'</span>,<span class="st">'Git1'</span>,<span class="st">'Gys1'</span>,<span class="st">'Hdac4'</span>,<span class="st">'Hnrnph3'</span>,<span class="st">'Hspa13'</span>,<span class="st">'Igfbp5'</span>,<span class="st">'Katnbl1'</span>,<span class="st">'Loxl3'</span>,<span class="st">'Lrrc4'</span>,<span class="st">'Lrrc8e'</span>,<span class="st">'Map3k8'</span>,<span class="st">'Mdga2'</span>,<span class="st">'Mex3c'</span>,<span class="st">'Mgat1'</span>,<span class="st">'Mmd'</span>,<span class="st">'Nkiras2'</span>,<span class="st">'Nr3c1'</span>,<span class="st">'Nsd3'</span>,<span class="st">'Nutf2'</span>,<span class="st">'Ogt'</span>,<span class="st">'Ostm1'</span>,<span class="st">'Pdgfra'</span>,<span class="st">'Pfn1'</span>,<span class="st">'Phf20l1'</span>,<span class="st">'Phyhip'</span>,<span class="st">'Pitx2'</span>,<span class="st">'Ppp1cc'</span>,<span class="st">'R3hdm1'</span>,<span class="st">'Reep1'</span>,<span class="st">'Rnf19a'</span>,<span class="st">'Rtkn2'</span>,<span class="st">'Senp1'</span>,<span class="st">'Siah1a'</span>,<span class="st">'Slc25a13'</span>,<span class="st">'Slc38a2'</span>,<span class="st">'Slc41a2'</span>,<span class="st">'Slf2'</span>,<span class="st">'Slmap'</span>,<span class="st">'Snx2'</span>,<span class="st">'Sox4'</span>,<span class="st">'Srr'</span>,<span class="st">'Stag1'</span>,<span class="st">'Stradb'</span>,<span class="st">'Syt6'</span>,<span class="st">'Taf9b'</span>,<span class="st">'Tbx3'</span>,<span class="st">'Trp53inp2'</span>,<span class="st">'Tshz1'</span>,<span class="st">'Tspan2'</span>,<span class="st">'Tssk2'</span>,<span class="st">'Ttyh2'</span>,<span class="st">'Vegfa'</span>,<span class="st">'Wnt1'</span>,<span class="st">'Yes1'</span>,<span class="st">'Zbed4'</span>,<span class="st">'Zbtb10'</span>,<span class="st">'Zfp182'</span>,<span class="st">'Zfp608'</span>,<span class="st">'Zfp654'</span><span class="op">)</span>

<span class="va">group</span> <span class="op">&lt;-</span>
<span class="va">table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>gene<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">character</a></span><span class="op">(</span><span class="op">)</span>, p.value<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span><span class="op">(</span><span class="op">)</span>, overall.mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span><span class="op">(</span><span class="op">)</span>, overall.variance<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span><span class="op">(</span><span class="op">)</span>, stringsAsFactors<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>

<span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">sample_data</span><span class="op">$</span><span class="va">expression</span><span class="op">[</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">sample_data</span><span class="op">$</span><span class="va">expression</span><span class="op">)</span>, pattern<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">'^'</span>, <span class="va">list.of.genes</span>, <span class="st">'$'</span>, collapse<span class="op">=</span><span class="st">'|'</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">data</span><span class="op">$</span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">vapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="st">'-'</span><span class="op">)</span>, <span class="va">`[`</span>, <span class="fl">2</span>, FUN.VALUE<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">character</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>

<span class="va">list.of.genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">numbers</span> <span class="op">~</span> <span class="va">group</span>, <span class="va">data</span><span class="op">)</span>

<span class="kw">for</span> <span class="op">(</span> <span class="va">i</span> <span class="kw">in</span> <span class="va">sample_data</span><span class="op">$</span><span class="va">samples</span><span class="op">$</span><span class="va">names</span> <span class="op">)</span> <span class="op">{</span>
  <span class="va">temp.table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="st">'.mean'</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">'.variance'</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">temp.table</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">i</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">temp.table</span><span class="op">)</span><span class="op">)</span>
  <span class="va">table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">table</span>, <span class="va">temp.table</span><span class="op">)</span>
<span class="op">}</span>

<span class="kw">for</span> <span class="op">(</span> <span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">list.of.genes</span><span class="op">)</span> <span class="op">)</span> <span class="op">{</span>
  <span class="va">temp.numbers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span>
  <span class="kw">for</span> <span class="op">(</span> <span class="va">j</span> <span class="kw">in</span> <span class="va">sample_data</span><span class="op">$</span><span class="va">samples</span><span class="op">$</span><span class="va">names</span> <span class="op">)</span> <span class="op">{</span>
    <span class="va">temp.numbers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">temp.numbers</span>, <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tapply.html">tapply</a></span><span class="op">(</span><span class="va">sample_data</span><span class="op">$</span><span class="va">expression</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">sample_data</span><span class="op">$</span><span class="va">expression</span><span class="op">)</span> <span class="op">==</span> <span class="va">list.of.genes</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>,<span class="op">]</span>, <span class="va">group</span>, <span class="va">withinRunStats</span><span class="op">)</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="va">temp.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>group<span class="op">=</span><span class="va">group</span>, numbers<span class="op">=</span><span class="va">sample_data</span><span class="op">$</span><span class="va">expression</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">sample_data</span><span class="op">$</span><span class="va">expression</span><span class="op">)</span> <span class="op">==</span> <span class="va">list.of.genes</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span>
  <span class="va">table</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
    <span class="va">list.of.genes</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,
    <span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">numbers</span> <span class="op">~</span> <span class="va">group</span>, <span class="va">temp.data</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="st">'group'</span>,<span class="st">'Pr(&gt;F)'</span><span class="op">]</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">sample_data</span><span class="op">$</span><span class="va">expression</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">sample_data</span><span class="op">$</span><span class="va">expression</span><span class="op">)</span> <span class="op">==</span> <span class="va">list.of.genes</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">sample_data</span><span class="op">$</span><span class="va">expression</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">sample_data</span><span class="op">$</span><span class="va">expression</span><span class="op">)</span> <span class="op">==</span> <span class="va">list.of.genes</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span>,
    <span class="va">temp.numbers</span>
  <span class="op">)</span>
<span class="op">}</span>

<span class="va">table</span><span class="op">$</span><span class="va">p.value</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">table</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span></code></pre></div>
</div>
</div>


  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>

</div>



      <footer>
      <div class="copyright">
  <p>Developed by Roman Hillje.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


